---
created:
  - " 06-03-2024 23:30"
aliases: 
tags:
  - article/
---

# Симплекс-метод

## Chapter 1

**Каноническая форма** задачи линейного программирования
Целевая функция - $f(x) = (c, x) \to max (min)$ 
Ограничения - $Ax=b, x\geq 0, b\geq 0$


Пример: 
$$f(x) = 2x_{1} - x_{2} + 5x_{3} \to max$$


**Первая и вторая стандартная** формы:

![[Pasted image 20240306233403.png]]


### Случаи приведения к каноническому виду
Переход от неравенствам к равенству (ограничения)

$$-x_{1}+10x_{2} \leq 1 \to -x_{1} + 10x_{2} + u_{1} = 1, \ \ u_{1} \geq 0$$


При $\geq$ - вычитаем переменную и требуем ее неотрицательности

**Свободные переменные** - когда не сказано, что происходит с одной из переменной - заменяем на разность $x_{i} = u_{3} - u_{4}$ и требуем их неотрицательности

%% 
$$
\begin{cases}
-x_{1}+1-x_{2}+u_{1} = 1 \\ \\
2x_{1} - 3x_{2} + x_{4}
\end{cases}
$$ %%


Симплекс-метод работает с канонической формой задачи ЛП.

#### Пример

$$f(x) = 3x_{1} + x_{2} \to max$$

$$
\begin{cases}
x_{1} - 2x_{2} \leq 1 \\ 
-2x_{1} + x_{2} \leq 2 \\
2x_{1} + x_{2} \leq 6 \\
x_{1} \geq 0, \ x_{2} \geq 0

\end{cases}

$$

Приводим задачу к **каноническому** виду:

$$f(x) = 3x_{1} + x_{2} \to max$$

$$
\begin{cases}
x_{1} - 2x_{2} + u_{1} = 1 \\ 
-2x_{1} + x_{2} +u_{2} = 2 \\
2x_{1} + x_{2} + u_{3} 6 \\
x_{1} \geq 0, \ x_{2} \geq 0 \\
u_{i} \geq 0

\end{cases}

$$

#### 1. Построение начальной симплексной таблицы

Строим матрицу с коэффициентами
![[Pasted image 20240306234745.png]]

Найти линейно независимый набор столбцов, строящих единичную матрицу: $u_{1}, u_{2}, u_{3}$ - базисные переменные, $x_{1}, x_{2}$ - небазисные

Симплекс таблица:

Направо - ограничения. Строка оценок - последняя строка. Скалярное произведение столбца и вычитаем верхнее значение:
**Получается как скалярное произведение вектора коэффициентов минус значение сверху**
![[Pasted image 20240306235208.png]]

Начальная симплекс-таблица задает промежуточное опорное решение ( подставляем значения коэффициентов).
![[Pasted image 20240306235403.png]]

##### Критерий оптимальности - неотрицательность оценок

#### 2. Выбор разрешающего элемента

**Выбор разрешающего элемента** - выбор разрешающего столбца и строка и на их пересечении

1) **столбец** - столбец с наибольшей по модулю отрицательной оценкой (наименьшей отрицательного)
2) **симплексной отношение** - отнощение правых частей к симплексным элементам. Отрицательные числа не берем!!!
3) **строка** - там, где симплекное отношение наименьшее

![[Pasted image 20240306235816.png]]

#### 3. Жорданово преобразование симплексной таблицы
![[Pasted image 20240307000759.png]]
1) Поменятть местами элементы главной строки и главного столбца (в примере $x_{1} \leftrightarrow u_{1}$)
2) $x_{rs} \to \frac{1}{x_{rs}}$ (главный элемент меняется на обратный)
3) главная строка делится на $x_{rs}$ (делим на старый элемент)
4) главный столбец делится на $x_{rs}$ и меняет знак на противоположный
5) Пересчет других элементов таблицы: $x'_{ij} = \frac{x_{rs} * x_{ij} - x_{rj}x_{is}}{x_{rs}} = x_{ij} - \frac{x_{rj}x_{is}}{x_{rs}}$:
	 ![[Pasted image 20240307000437.png]]
	Похоже на вычисление опредделителя 
(убираем одну отрицательную оценку одним шагом)

**Симплексная таблица неоптимальная, так как есть отрицательный элемент**

Находим новый разрешающий элемент

#### 4. Новая итерация
![[Pasted image 20240307001126.png]]
**С каждым переходом симплексной таблицы результат не ухудшается**

Новый шаг преобразования:
![[Pasted image 20240307001201.png]]

1) ![[Pasted image 20240307001222.png]]
2) ![[Pasted image 20240307001256.png]]
3) ![[Pasted image 20240307001306.png]]
4) ![[Pasted image 20240307001526.png]]

**Таблица оптимальная**, так как все оценки неотрицательны

#### 5. Оптимальное решение

$$x^{*}= (x_{1}, x_{2}, u_{1}, u_{2}, u_{3}) = \left( \frac{13}{5}, \frac{4}{5}, 0, \frac{32}{5}, 0\right)$$
$$f^{*}= \frac{43}{5} = 3 * \frac{13}{5}  + \frac{4}{5}$$

